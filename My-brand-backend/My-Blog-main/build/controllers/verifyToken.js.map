{"version":3,"sources":["../../src/controllers/verifyToken.js"],"names":["jwt","require","config","verifyToken","req","res","next","bearerHeader","headers","bearer","split","bearerToken","verify","secret","err","user","sendStatus","console","log"],"mappings":";;;;;;;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AACA,IAAMC,MAAM,GAAGD,OAAO,CAAC,QAAD,CAAtB,C,CAEA;;;AACA,SAASE,WAAT,CAAqBC,GAArB,EAA0BC,GAA1B,EAA+BC,IAA/B,EAAqC;AACjC,MAAMC,YAAY,GAAGH,GAAG,CAACI,OAAJ,CAAY,eAAZ,CAArB;;AACA,MAAG,OAAOD,YAAP,KAAwB,WAA3B,EAAwC;AACtC,QAAME,MAAM,GAAGF,YAAY,CAACG,KAAb,CAAmB,GAAnB,CAAf;AACA,QAAMC,WAAW,GAAGF,MAAM,CAAC,CAAD,CAA1B,CAFsC,CAG1C;;AACET,IAAAA,GAAG,CAACY,MAAJ,CAAWD,WAAX,EAAwBT,MAAM,CAACW,MAA/B,EAAuC,UAACC,GAAD,EAAKC,IAAL,EAAa;AAClD;AACE,UAAID,GAAJ,EAAS,OAAOT,GAAG,CAACW,UAAJ,CAAe,GAAf,CAAP;AACTZ,MAAAA,GAAG,CAACW,IAAJ,GAAWA,IAAX;AACH,KAJD;AAKET,IAAAA,IAAI;AACL,GAVD,MAUO;AACLW,IAAAA,OAAO,CAACC,GAAR,CAAYX,YAAZ;AACAF,IAAAA,GAAG,CAACW,UAAJ,CAAe,GAAf;AACD;AAEF","sourcesContent":["const jwt = require(\"jsonwebtoken\")\r\nconst config = require(\"config\");\r\n\r\n// Verify Token\r\nfunction verifyToken(req, res, next) {\r\n    const bearerHeader = req.headers['authorization'];\r\n    if(typeof bearerHeader !== 'undefined') {\r\n      const bearer = bearerHeader.split(' ');\r\n      const bearerToken = bearer[1];\r\n  // console.log(bearerToken)\r\n    jwt.verify(bearerToken, config.secret, (err,user) =>{\r\n      // console.log(err)\r\n        if (err) return res.sendStatus(401);\r\n        req.user = user;\r\n    })\r\n      next();\r\n    } else {\r\n      console.log(bearerHeader)\r\n      res.sendStatus(401);\r\n    }\r\n  \r\n  }\r\nexport{ verifyToken }"],"file":"verifyToken.js"}
{"version":3,"sources":["../../src/routes/comment.js"],"names":["express","require","validateComment","Comment","Article","router","Router","validateMiddleWare","get","req","res","find","comments","send","sendStatus","Like","length","console","error","post","verifyToken","newComment","articleId","body","comment","userId","user","save","log","deleteOne","params","id","status","module","exports"],"mappings":"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","sourcesContent":["const express = require(\"express\");\r\nconst {validateComment,Comment } = require(\"../models/Comment\");\r\nconst {Article } = require(\"../models/Like\");\r\n\r\nconst router = express.Router();\r\nconst validateMiddleWare = require('../middlewares/validateMiddleware')\r\n\r\nimport { verifyToken } from \"../controllers/verifyToken\";\r\n\r\n\r\n\r\nrouter.get(\"/\",  async(req,res)=>{\r\n    try {\r\n        const comments = await Comment.find({});\r\n        res.send(comments);\r\n    } catch (error){\r\n        // console.log(error)\r\n        res.sendStatus(500);\r\n    }\r\n\r\n})\r\n\r\n\r\nrouter.get(\"/:id\", async (req,res) =>{\r\n    try {\r\n        const comments = await Like.find({})\r\n    \r\n        res.send({comments: comments.length})   \r\n    } catch(error)  {\r\n        console.error(error);\r\n        res.sendStatus(404);\r\n    }\r\n\r\n})\r\n\r\nrouter.post(\"/\",verifyToken,validateMiddleWare(validateComment) , async (req,res) =>{\r\n   try {\r\n\r\n    const newComment = new Comment({\r\n        articleId : req.body.articleId,\r\n        comment:req.body.comment,\r\n        userId : req.user[\"id\"]\r\n        })\r\n\r\n        await newComment.save();\r\n    res.sendStatus(201).send(\"\")     \r\n   } catch (error){\r\n       res.sendStatus(400);\r\n     console.log(error)\r\n     console.log(req.user)\r\n    //  console.log(req.user[\"user\"][\"_id\"])\r\n   }\r\n})\r\n\r\n\r\nrouter.delete(\"/:id\", verifyToken,validateMiddleWare(validateComment), async (req, res) => {\r\n\ttry {\r\n\t\tawait Like.deleteOne({ articleId: req.params.id , userId:req.user[\"user\"][\"_id\"]})\r\n\t\tres.sendStatus(204);\r\n\t} catch {\r\n\t\tres.status(404)\r\n\t\tres.send({ error: \"Problem disliking\" })\r\n\t}\r\n})\r\n\r\nmodule.exports = router;"],"file":"comment.js"}
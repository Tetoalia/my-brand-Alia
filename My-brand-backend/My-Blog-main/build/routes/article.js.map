{"version":3,"sources":["../../src/routes/article.js"],"names":["express","require","validateArticle","Article","router","Router","validateMiddleWare","get","verifyToken","req","res","find","articles","status","send","error","findOne","_id","params","id","post","heading","body","content","userId","user","image","newArticle","save","Message","deleteOne","put","module","exports"],"mappings":"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","sourcesContent":["const express = require(\"express\");\r\nconst {validateArticle, Article } = require(\"../models/Article\");\r\nconst router = express.Router();\r\nconst validateMiddleWare = require('../middlewares/validateMiddleware')\r\n\r\nimport { verifyToken } from \"../controllers/verifyToken\";\r\nimport validateMiddleware from \"../middlewares/validateMiddleware\";\r\n\r\n\r\n\r\nrouter.get(\"/\", verifyToken,  async(req,res)=>{\r\n    try {\r\n        const articles = await Article.find({});\r\n        res.status(200).send(articles);\r\n    } catch (error){\r\n        res.status(500).send({error:\"Problem with request\"})\r\n    }\r\n\r\n})\r\n\r\nrouter.get(\"/:id\", verifyToken, async (req,res) =>{\r\n    try {\r\n        const Article = await Article.findOne({\r\n            _id: req.params.id\r\n        })\r\n    \r\n        res.send(Article)   \r\n    } catch  {\r\n        res.status(404)\r\n        res.send({error: \"Article doesn't exist !\"})\r\n    }\r\n\r\n})\r\n\r\nrouter.post(\"/\",verifyToken, validateMiddleware(validateArticle), async (req,res) =>{\r\n   // console.log(req.body)\r\n   try {\r\n\r\n    const newArticle =await new Article({\r\n        heading : req.body.heading,\r\n        content : req.body.content,\r\n        userId: req.user[\"id\"],\r\n        image : req.body.image,\r\n        })\r\n       // console.log(req.user[\"id\"])\r\n     await newArticle.save();\r\n\r\n     res.status(201).send({Message:\"New Article Created\"})     \r\n   } catch (error){\r\n       res.status(400).send({error:\"There was a problem publishing the article\"})\r\n    //    console.log(error)\r\n   }\r\n})\r\n\r\n\r\nrouter.delete(\"/:id\", verifyToken, async (req, res) => {\r\n\ttry {\r\n\t\tawait Article.deleteOne({ _id: req.params.id })\r\n\t\tres.status(204).send()\r\n\t} catch {\r\n\t\tres.status(404).send({ error: \"This article doesn't exist!\" })\r\n\t}\r\n})\r\n\r\nrouter.put(\"/:id\", validateMiddleWare(validateArticle) ,async (req, res) => {\r\n\ttry {\r\n\t\tconst Article = await Article.findOne({ _id: req.params.id })\r\n\r\n\t\tif (req.body.heading) {\r\n\t\t\tArticle.heading = req.body.heading\r\n\t\t}\r\n\r\n\t\tif (req.body.content) {\r\n\t\t\tArticle.content = req.body.content\r\n\t\t}\r\n\t\tif (req.body.image) {\r\n\t\t\tArticle.content = req.body.content\r\n\t\t}\r\n\t\tawait Article.save()\r\n\t\tres.send(Article)\r\n\t} catch {\r\n\t\tres.status(404)\r\n\t\tres.send({ error: \"Article doesn't exist!\" })\r\n\t}\r\n})\r\n\r\n\r\nmodule.exports = router;"],"file":"article.js"}
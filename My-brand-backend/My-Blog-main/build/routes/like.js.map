{"version":3,"sources":["../../src/routes/like.js"],"names":["express","require","validateLike","Like","Article","router","Router","validateMiddleWare","get","req","res","find","likes","status","send","sendStatus","error","console","log","articleId","params","id","length","post","verifyToken","newLike","body","userId","user","save","deleteOne","module","exports"],"mappings":"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","sourcesContent":["const express = require(\"express\");\r\nconst {validateLike,Like } = require(\"../models/Like\");\r\nconst {Article } = require(\"../models/Like\");\r\n\r\nconst router = express.Router();\r\nconst validateMiddleWare = require('../middlewares/validateMiddleware')\r\n\r\nimport { verifyToken } from \"../controllers/verifyToken\";\r\n\r\n\r\n\r\nrouter.get(\"/\",  async(req,res)=>{\r\n    try {\r\n        const likes = await Like.find({});\r\n        res.status(200).send(likes);\r\n    } catch (error){\r\n        res.sendStatus(500).send({error:\"Problem with request\"})\r\n        console.log(error)\r\n\r\n    }\r\n\r\n})\r\n\r\nrouter.get(\"/:id\", async (req,res) =>{\r\n    try {\r\n        const likes = await Like.find({articleId:req.params.id})\r\n    \r\n        res.send({likes: likes.length})   \r\n    } catch(error)  {\r\n        console.error(error);\r\n        res.sendStatus(404);\r\n    }\r\n\r\n})\r\n\r\nrouter.post(\"/\",verifyToken,validateMiddleWare(validateLike) , async (req,res) =>{\r\n   try {\r\n\r\n    const newLike = new Like({\r\n        articleId : req.body.articleId,\r\n        userId : req.user[\"id\"]\r\n        })\r\n\r\n        await newLike.save();\r\n    res.sendStatus(201).send(\"\")     \r\n   } catch (error){\r\n       res.sendStatus(400).send({error:\"There was a problem adding a like\"})\r\n    // console.log(error)\r\n   }\r\n})\r\n\r\n\r\nrouter.delete(\"/:id\", verifyToken,validateMiddleWare(validateLike), async (req, res) => {\r\n\ttry {\r\n\t\tawait Like.deleteOne({ articleId: req.params.id , userId:req.user[\"user\"][\"_id\"]})\r\n\t\tres.sendStatus(204);\r\n\t} catch {\r\n\t\tres.status(404)\r\n\t\tres.send({ error: \"Problem disliking\" })\r\n\t}\r\n})\r\n\r\nmodule.exports = router;"],"file":"like.js"}
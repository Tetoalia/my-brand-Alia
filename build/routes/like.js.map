{"version":3,"sources":["../../src/routes/like.js"],"names":["express","require","validateLike","Like","validateDislike","Dislike","Article","router","Router","validateMiddleWare","get","req","res","find","likes","status","send","error","articleId","params","id","length","Message","_id","like","dislikes","post","verifyToken","findOne","body","userId","user","likeExists","dislikeExists","deleteOne","newLike","save","sendStatus","newDislike","module","exports"],"mappings":"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","sourcesContent":["const express = require(\"express\");\nconst {validateLike,Like } = require(\"../models/Like\");\nconst {validateDislike,Dislike } = require(\"../models/Dislike\");\nconst {Article } = require(\"../models/Like\");\n\nconst router = express.Router();\nconst validateMiddleWare = require('../middlewares/validateMiddleware')\n\nimport e from \"express\";\nimport { verifyToken } from \"../controllers/verifyToken\";\n\n/**\n * @swagger\n * security:\n *   bearerAuth: []\n * /like:\n *   get:\n *     summary: GET Likes\n *     tags:\n *       - Like\n *     responses:\n *       '400':\n *         description: Bad Request \n *       '401':\n *         description: Unauthorized\n *       '200':\n *         description: A list of likes on articles.\n *         content:\n *           application/json:\n *             schema:\n *               type: array\n *               items:\n *                 type: object\n *                 properties:\n *                   name:\n *                     articleId: string\n *                     description: The Id of the article with like.\n *                   userId:\n *                     type: string\n *                     description: The Id of the user who gave the like\n */\n\nrouter.get(\"/\",  async(req,res)=>{\n    try {\n        const likes = await Like.find({});\n        res.status(200).send(likes);\n    } catch (error){\n        res.status(500).send({error:\"Problem fetching likes\"})\n      //  console.log(error)\n    }\n\n})\n\n/**\n * @swagger\n * \"/like/article/{articleId}\":\n *   get:\n *     summary: Find likes for one article\n *     tags: \n *       - Like\n *     parameters:\n *       - name: articleId\n *         in: path\n *         required: true\n *         schema:\n *           type: string\n *         description: The Id of the article\n *     responses:\n *       '200':\n *         description: OK\n *       '404':\n *         description:  Not found\n  */\n\nrouter.get(\"/article/:id\", async (req,res) =>{\n    try {\n        const likes = await Like.find({articleId:req.params.id})\n    \n        res.status(200).send({likes: likes.length})   \n    } catch(error)  {\n        // console.error(error);\n        res.status(404).send({Message:\"No like for this particular article\"});\n    }\n\n})\n\nrouter.get(\"/:id\", async (req,res) =>{\n    try {\n        const like = await Like.find({_id:req.params.id})\n    \n        res.status(200).send({like: like})   \n    } catch(error)  {\n        // console.error(error);\n        res.status(404).send({Message:\"No like for this particular article\"});\n    }\n\n})\n\n\n\nrouter.get(\"/dislike/:id\", async (req,res) =>{\n    try {\n        const dislikes = await Dislike.find({articleId:req.params.id})\n    \n        res.status(200).send({dislikes: dislikes.length})   \n    } catch(error)  {\n        // console.error(error);\n        res.status(404).send({Message:\"No dislikes for this particular article\"});\n    }\n\n})\n\nrouter.get(\"/:id\", async (req,res) =>{\n    try {\n        const like = await Like.find({_id:req.params.id})\n    \n        res.status(200).send({like: like})   \n    } catch(error)  {\n        // console.error(error);\n        res.status(404).send({Message:\"No like for this particular article\"});\n    }\n\n})\n/** \n* @swagger\n* /like:\n*   post:\n*     summary: Add New Like\n*     tags:\n*       - Like\n*     requestBody:\n*       required: true\n*       content:\n*         application/json:\n*             schema:\n*               type: object\n*               properties:\n*                 articleId:\n*                   type: string\n*                   description: The id of the article to like\n*                  \n*     responses:\n*       '400':\n*         description: Bad Request \n*       '201':\n*         description: Like added.\n*         content:\n*           application/json:\n*             schema:\n*               type: object\n*               properties:\n*                 Message:\n*                   type: string\n*/\n\nrouter.post(\"/\",verifyToken,validateMiddleWare(validateLike) , async (req,res) =>{\n   try {\n   let likeExists = await Like.findOne({articleId:req.body.articleId, userId: req.user[\"id\"]});\n   let dislikeExists = await Dislike.findOne({articleId:req.body.articleId, userId: req.user[\"id\"]});\n   //check if user has disliked article and remove dislike\n   if (dislikeExists) {\n       await Dislike.deleteOne({ articleId: req.body.articleId , userId:req.user[\"id\"]})\n    }\n    else{\n        //Add New like if a user have previously liked the article\n            if (!likeExists) {\n                const newLike = new Like({\n                    articleId : req.body.articleId,\n                    userId : req.user[\"id\"]\n                    })\n            \n                    await newLike.save();\n                res.status(201).send({Message:\"Like added successfully\"})    \n            } else {\n                res.status(405).send({Message: \"User already liked the article\"})\n            }\n   }\n     \n   } catch (error){\n       res.sendStatus(500).send({error:\"There was a problem adding a like\"})\n    // console.log(error)\n   }\n})\n\n\n/**\n * @swagger\n * \"/like/{articleId}\":\n *   delete:\n *     summary: Dislike an article\n *     tags: \n *       - Like\n *     parameters:\n *       - name: articleId\n *         in: path\n *         required: true\n *         schema:\n *           type: string\n *         description: The Id of the article\n*     responses:\n*       '400':\n*         description: Bad Request \n*       '201':\n*         description: Article disliked successfully.\n*         content:\n*           application/json:\n*             schema:\n*               type: object\n*               properties:\n*                 Message:\n*                   type: string\n */\n\nrouter.delete(\"/:id\", verifyToken,validateMiddleWare(validateLike), async (req, res) => {\n\ttry {\n        //check if a user has previously liked the article\n        let likeExists = Like.findOne({articleId:req.body.articleId, userId: req.user[\"id\"]});\n         if (likeExists) {\n            await Like.deleteOne({ articleId: req.params.id , userId:req.user[\"id\"]})\n         }\n         let dislikeExists =await Dislike.findOne({articleId:req.body.articleId, userId: req.user[\"id\"]});\n\n         //check if user has disliked article and remove dislike\n         if (dislikeExists) {\n            res.status(405).send({Message: \"User already disliked the article\"})\n        }else{\n            const newDislike = new Dislike({\n                articleId : req.body.articleId,\n                userId : req.user[\"id\"]\n                })\n        \n                await newDislike.save();\n\n            res.status(201).send({Message:\"you have disliked this article\"}) \n            }\n\t} catch {\n\t\tres.status(500).send({ error: \"Problem disliking\" })\n\t}\n})\n\nmodule.exports = router;\n"],"file":"like.js"}
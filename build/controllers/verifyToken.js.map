{"version":3,"sources":["../../src/controllers/verifyToken.js"],"names":["jwt","require","config","verifyToken","req","res","next","bearerHeader","headers","authorization","bearerToken","split","sendStatus","verify","secret","err","user","console","log"],"mappings":";;;;;;;AAAA;;AAEA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AACA,IAAMC,MAAM,GAAGD,OAAO,CAAC,QAAD,CAAtB,C,CAEA;;;AACA,SAASE,WAAT,CAAqBC,GAArB,EAA0BC,GAA1B,EAA+BC,IAA/B,EAAqC;AACnC,MAAG;AACD,QAAMC,YAAY,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAAjC;AACA,QAAMC,WAAW,GAAGH,YAAY,IAAIA,YAAY,CAACI,KAAb,CAAmB,GAAnB,EAAwB,CAAxB,CAApC;AACA,QAAIJ,YAAY,IAAI,IAApB,EAA0B,OAAOF,GAAG,CAACO,UAAJ,CAAe,GAAf,CAAP;AAE1BZ,IAAAA,GAAG,CAACa,MAAJ,CAAWH,WAAX,EAAwBR,MAAM,CAACY,MAA/B,EAAuC,UAACC,GAAD,EAAKC,IAAL,EAAa;AAClD;AACE,UAAID,GAAJ,EAAS,OAAOV,GAAG,CAACO,UAAJ,CAAe,GAAf,CAAP;AACTR,MAAAA,GAAG,CAACY,IAAJ,GAAWA,IAAX;AACAV,MAAAA,IAAI;AACP,KALD;AAMD,GAXD,CAYA,OAAMS,GAAN,EAAU;AACRE,IAAAA,OAAO,CAACC,GAAR,CAAYH,GAAZ;AACD;AAEA","sourcesContent":["import { send } from \"express/lib/response\";\n\nconst jwt = require(\"jsonwebtoken\")\nconst config = require(\"config\");\n\n// Verify Token\nfunction verifyToken(req, res, next) {\n  try{\n    const bearerHeader = req.headers.authorization;\n    const bearerToken = bearerHeader && bearerHeader.split(' ')[1];\n    if (bearerHeader == null) return res.sendStatus(401);\n\n    jwt.verify(bearerToken, config.secret, (err,user) =>{\n      // console.log(err)\n        if (err) return res.sendStatus(403);\n        req.user = user;\n        next();\n    })\n  }\n  catch(err){\n    console.log(err)\n  }\n  \n  }\nexport{ verifyToken }"],"file":"verifyToken.js"}